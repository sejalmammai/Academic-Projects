public class Book {
	
    private String title;
    private String author;
    private boolean isBorrowed;
    private String genre;

    public Book(String title, String author, String genre) {
    	
        this.title = title;
        this.author = author;
        this.genre = genre;
        this.isBorrowed = false;
        
    }

    public String getAuthor() {
        return author;
    }

    public String getGenre() {
        return genre;
    }

    public String getTitle() {
        return title;
    }

    public boolean isBorrowed() {
        return isBorrowed;
    }

    public void setBorrowed() {
        this.isBorrowed = !this.isBorrowed;
    }

    public boolean equals(Object obj) {   
        return title.equals(this.title) && author.equals(this.author);
    }

    public String toString() {
        return title + " by " + author + "(" + genre + ")";
    }
}

public class Library {
	
    private Book[][] sections;

    public Library() {
        sections = new Book[4][5];
    }

    private int getSectionIndex(String title) {
    	
        char firstLetter = Character.toUpperCase(title.charAt(0));
        
        if (firstLetter >= 'A' && firstLetter <= 'F') {
            return 0;
            
        } 
        
        else if (firstLetter >= 'G' && firstLetter <= 'L') {
            return 1;
        } 
        
        else if (firstLetter >= 'M' && firstLetter <= 'R') {
            return 2;
        } 
        
        else if (firstLetter >= 'S' && firstLetter <= 'Z') {
            return 3;
        }
        
        return -1; 
    }

    public Book lookupBook(String title) {
    	
        int sectionIndex = getSectionIndex(title);
        if (sectionIndex == -1) return null;

        for (Book book : sections[sectionIndex]) {
        	
            if (book != null && book.getTitle().equals(title)) {
                return book;
            }
            
        }
        
        return null;
        
    }

    public boolean addBook(Book book) {
    	
        int sectionIndex = getSectionIndex(book.getTitle());
        
        if (sectionIndex == -1) {
        	return false;
        }

        for (int i = 0; i < sections[sectionIndex].length; i++) {
        	
            if (sections[sectionIndex][i] == null) {
            	
                sections[sectionIndex][i] = book;
                return true;
                
            }
        }
        
        System.out.println("Over capacity - can't add");
        return false;
        
    }

    public boolean removeBook(Book book) {
    	
        int sectionIndex = getSectionIndex(book.getTitle());
        if (sectionIndex == -1) {
        	return false;
        }

        for (int i = 0; i < sections[sectionIndex].length; i++) {
        	
            if (sections[sectionIndex][i] != null && sections[sectionIndex][i].equals(book)) {
               
            	if (sections[sectionIndex][i].isBorrowed()) {
                    System.out.println("Can't remove a borrowed book");
                    return false;
                }
            	
                sections[sectionIndex][i] = null;
                return true;
                
            }
        }
        
        System.out.println("No book found");
        return false;
        
    }

    public boolean loanBook(String title, String author) {
    	
        int sectionIndex = getSectionIndex(title);
        
        if (sectionIndex == -1) {
            System.out.println("That Book does not exist in this Library");
            return false;
        }

        for (Book book : sections[sectionIndex]) {
        	
            if (book != null && book.getTitle().equals(title) && book.getAuthor().equals(author)) {
               
            	if (book.isBorrowed()) {
                    System.out.println("Sorry, this is already loaned");
                    return false;
                }
                
                book.setBorrowed();
                return true;
                
            }
            
        }
        
        System.out.println("That Book does not exist in this Library");
        return false;
        
    }

    public boolean returnBook(Book bookToReturn) {
    	
        int sectionIndex = getSectionIndex(bookToReturn.getTitle());
       
        if (sectionIndex == -1) {
            System.out.println("That Book cannot be returned here");
            return false;
        }

        for (Book book : sections[sectionIndex]) {
           
        	if (book != null && book.equals(bookToReturn)) {
                
        		if (book.isBorrowed()) {
                    book.setBorrowed();
                    return true;
                } 
                
                else {
                    System.out.println("That Book cannot be returned here");
                    return false;
                }
            }
        	
        }
        
        System.out.println("That Book cannot be returned here");
        return false;
        
    }

    public void listBooks() {
    	
        String[] sectionRanges = {"A - F", "G - L", "M - R", "S - Z"};
        
        for (int i = 0; i < sections.length; i++) {
        	
            System.out.println("Section: " + sectionRanges[i]);
            boolean sectionEmpty = true;
            
            for (Book book : sections[i]) {
            	
                if (book != null) {
                    System.out.println("Title: " + book.getTitle() + " by " + book.getAuthor() + " (" + book.getGenre() + ") - " + (book.isBorrowed() ? "Unavailable" : "Available"));
                    sectionEmpty = false;
                }
                
            }
            
            if (sectionEmpty) {
                System.out.println("(Empty)");
            }
            
        }
    }
}
